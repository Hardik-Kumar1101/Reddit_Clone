<!DOCTYPE html>
<html lang="en" xmlns:th="http://www.thymeleaf.org">
<head>
    <meta charset="UTF-8">
    <title>Create Post</title>
    <link rel="stylesheet" th:href="@{/css/create-post.css}"/>
</head>
<body>

<form th:action="@{/save-post}" method="post" th:object="${post}" enctype="multipart/form-data">

    <div th:if="${post.postId == null}">
        <label for="postName">Post Name:</label>
        <input type="text" id="postName" name="postName" th:field="*{postName}" required><br>
    </div>
    <div th:if="${post.postId != null}">
        <div th:text="${post.postName}"></div>
    </div>


    <label for="url">URL:</label>
    <input type="text" id="url" name="url" th:field="*{url}" th:readonly="${post.postId != null}"><br>

    <label for="description">Description:</label>
    <textarea id="description" name="description" th:field="*{description}" required></textarea><br>

    <div th:if="${post.postId == null}">
        <label for="subreddit">Select Subreddit:</label>
        <select id="subreddit" name="subreddit.subredditId" th:field="*{subreddit.subredditId}" th:readonly="${post.postId != null}" required>
            <option value="">Select</option>
            <option th:each="subreddit : ${subreddits}" th:value="${subreddit.subredditId}" th:text="${subreddit.name}"></option>
        </select><br>
    </div>
    <div th:if="${post.postId != null}">
    <div th:if="${post.media != null}">
        <div th:if="${post.media.contentType.startsWith('image/')}">
            <img height="25px" width="10%" th:src="@{${'/display?id=' + post.media.mediaId}}" alt="Image">
        </div>

        <div th:if="${post.media.contentType.startsWith('video/')}">
            <video width="100%" controls>
                <source th:src="@{${'/display?id=' + post.media.mediaId}}" th:type="${post.media.contentType}">
                Your browser does not support the video tag.
            </video>
        </div>

    </div>
    </div>
    <input type="file" name="file" aria-describedby="inputGroupFileAddon04" aria-label="Upload">
    <input type="submit" name="action" value="Draft" th:if="${post.postId == null}">
    <input type="submit" name="action" value="Publish" th:if="${post.postId == null}">
    <div th:if="${post.postId != null}">
        <input type="hidden" name="postId"  th:value="${post.postId}">
        <input type="hidden" name="subreddit" th:value="${post.subreddit.subredditId}">
        <input type="hidden" name="createdAt" th:value="${post.createdAt}">
        <input type="submit" name="action" value="Update" th:if="${post.isPublished == true}">
        <input type="submit" name="action" value="Update Draft" th:if="${post.isPublished == false}">
    </div>
</form>

</body>
</html>

